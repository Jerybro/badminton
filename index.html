<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="/badminton/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="羽球场地排队系统" />
    <link rel="manifest" href="/badminton/manifest.json" />
    <title>羽球排队</title>
  </head>
  <body>
    <noscript>您需要启用 JavaScript 才能运行此应用。</noscript>
    <div id="root"></div>
    <script>
      // 调试信息
      console.log('开始加载应用...');

      // 动态加载 CSS
      fetch('/badminton/asset-manifest.json')
        .then(response => {
          console.log('获取 asset-manifest.json 成功');
          return response.json();
        })
        .then(data => {
          console.log('解析 asset-manifest.json 成功:', data);
          const link = document.createElement('link');
          link.rel = 'stylesheet';
          link.href = data.files['main.css'];
          document.head.appendChild(link);
          console.log('CSS 加载完成:', link.href);
        })
        .catch(error => {
          console.error('加载 CSS 失败:', error);
        });

      // 动态加载脚本
      const loadScript = (src) => {
        console.log('开始加载脚本:', src);
        return new Promise((resolve, reject) => {
          const script = document.createElement('script');
          script.src = src;
          script.onload = () => {
            console.log('脚本加载成功:', src);
            resolve();
          };
          script.onerror = (error) => {
            console.error('脚本加载失败:', src, error);
            reject(error);
          };
          document.body.appendChild(script);
        });
      };

      // 加载主应用代码
      fetch('/badminton/asset-manifest.json')
        .then(response => response.json())
        .then(data => {
          console.log('开始加载主应用代码:', data.files['main.js']);
          return loadScript(data.files['main.js']);
        })
        .then(() => {
          console.log('应用加载完成！');
        })
        .catch(error => {
          console.error('应用加载过程中出错:', error);
        });
    </script>
  </body>
</html> 